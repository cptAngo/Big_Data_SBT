#?????????????????? ????????
df = read.csv('zipincome.txt')

#???????????????? ???????????????? ??????????????
names(df) <- c("zipCode", "income")

#?????????????? mean and median
mn = mean(df[,'income'])
md = median(df[,'income'])

#???????????? scatterplot
plot(df[,'zipCode'], df[,'income'])

#???????????? subset 
subdf = subset(df, income > 7000 & income < 200000)

#?????????????? ?????????? ??????????????
new_mn = mean(subdf[,'income'])

#???????????? boxplot
boxplot(subdf[,'income']~subdf[,'zipCode'], subdf, main=' Average Household Income by Zip Code', 
        xlab='Zip Codes', ylab='Income')

#???????????? boxplot ?? ?????????????????????????????? ????????????
boxplot(subdf[,'income']~subdf[,'zipCode'], subdf, main=' Average Household Income by Zip Code', 
        xlab='Zip Codes', ylab='Income', log='y')

#???????????????? ggplot ?????? ?? ???????????? f
ggplot(subdf, aes(x=as.factor(zipCode), income)) + geom_point(position='jitter', alpha=0.2) +
  scale_y_log10()

#???????????????? ggplot ?????? ?? ???????????? g
ggplot(subdf, aes(x = as.factor(zipCode), income)) + 
  geom_point(aes(colour=factor(zipCode)), position="jitter", alpha=0.2) + 
  geom_boxplot(alpha=0.1, outlier.size=-Inf) + scale_y_log10() + 
  ylab("Income") + xlab("Zip Code") + labs(color="Region") + ggtitle("Average Income by Zip Code")





